---
title: "GGG-201D-problem-set-2"
author: "Ethan Holleman"
date: "4/28/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1

### Part A
Use a program such as R or Excel to generate a scatter plot that shows how expected allele frequency change from genetic drift depends on initial allele frequency. The x-axis should be initial allele frequency and range from 0 to 1. The y-axis should be expected change in allele frequency after one generation. Perform calculations in steps of 0.1 for a population size of 2N=20.

```{r}

expected <- function(init_allele_freq, pop_size, delta_allele_freq){
  
  num_delta_alleles <- pop_size * delta_allele_freq
  num_init_alleles <- pop_size * init_allele_freq
  routes <- num_init_alleles + c(-1*num_delta_alleles, num_delta_alleles)
  routes <- unique(routes[routes >= 0])  # remove negative values since not possible
  sum(mapply(dbinom, routes, pop_size, init_allele_freq))
  
}
```

```{r}
expected_change <- function(init_allele_freq, pop_size){
  
  magnitudes <- seq(0, 1-init_allele_freq, 0.1)
  sum(mapply(expected, init_allele_freq, pop_size, magnitudes) * magnitudes)

}
```


```{r}
library(ggplot2)
library(ggpubr)

df.a <- data.frame(init_allele_freq=seq(0, 1, 0.1), pop_size=10)
df.a$delta_allele_freq <- mapply(expected_change, df.a$init_allele_freq, df.a$pop_size)
ggplot(df.a, aes(x=init_allele_freq, y=delta_allele_freq)) + geom_line(color='dodgerblue') +
      theme_pubclean() + labs(x='Initial allele frequency', y='Change allele freq after 1 gen')
  
```

```{r, echo=FALSE}
colnames(df.a) <- c('Initial allele frequency', 'Pop size', 'Delta allele freq 1 gen')
knitr::kable(df.a)
```

### Part B

Use the same program to generate a scatter plot that shows how expected allele frequency change from genetic drift depends on population size. The x-axis should be population size and range from 2N=10 to 2N=100. The y-axis should be expected change in allele frequency after one generation. Perform calculations in steps of 10 with an allele frequency of 0.5

```{r}
df.b <- data.frame(init_allele_freq=0.5, pop_size=seq(10, 100, 10))
df.b$delta_allele_freq <- mapply(expected_change, df.b$init_allele_freq, df.b$pop_size)
ggplot(df.b, aes(x=pop_size, y=delta_allele_freq)) + geom_line(color='darkred') +
      theme_pubclean() + labs(x='Population size', y='Change allele freq after 1 gen')
```

```{r, echo=FALSE}
colnames(df.b) <- c('Initial allele frequency', 'Pop size', 'Delta allele freq 1 gen')
knitr::kable(df.b)
```